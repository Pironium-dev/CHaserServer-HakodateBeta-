
# 概要

旭川版 CHaser (※)のサーバの機能をより拡張し、CHaserの学習を効率化したい。

[※ CHaser には、全国情報技術教育研究会版とそれを簡略化した旭川版があります。](https://ja.wikipedia.org/wiki/CHaser)

## インストール

Releacesからダウンロード後、launch.batまたはlaunch.shでサーバを起動できます。  

+ Windows版  
python3.11.3で動作確認をしました。  
+ Linux&Mac版  
python3.11.3,WSL:Ubuntu,Macで動作確認をしました。  
使用するには、以下のコードでtkinterをインストールしてください。

```terminal
brew install python-tk@3.11
```

また、launch.shに以下のコードで実行権限を付与してください

```terminal
chmod +x launch.sh
```

はじめから2022年の函館大会で使用されたマップが入っています。

### サーバーの使い方

基本的には旭川版の操作と似ています。説明に出てくる数字（①等）は下の写真のものです。

 - 試合開始まで  
    ①番でクライアントの設定をして、待機開始を押します。
    両方接続を完了したら⑥を押して試合開始です。  
    中央にあるモードはそれぞれ以下のような意味です。

  1. User  
    手動でクライアントをつなげます（旭川版と同じ）
  2. Stay  
    その場にとどまります（旭川版と同じ）
  3. Bot  
    launch.batやlaunch.shが置かれているフォルダの中にClientsというフォルダが入っています。
    その中にあるBot.pyを自動で起動して接続します。  

## 画面の説明

### サーバ

![explanation](pictures/explanation.png)

1. クライアント設定  
    左から、ポート番号、モード、待機接続ボタン  
    モード:  User(通常) Stay(その場待機) Bot(./Clients/Bot.pyを実行する)
2. マッププレビュー  
    3で指定したマップを表示します
3. マップ設定  
    mapsフォルダ内から指定します  
    ランダムボタン:mapsフォルダ内からランダムで選択します
4. IPアドレス
    サーバーのIPアドレスを表示します
5. 設定  
    ログ保存:logフォルダに試合のログを保存します  
    タイムアウト:通信のタイムアウト速度を調整します  
    進行速度:ゲームの進行速度を調整します  
    ログ、マップ保存場所:それぞれのフォルダ位置を変更します。
    設定のリセット:上記の設定をすべてリセットします。
6. ゲーム開始  
    クライアントがすべて接続した後押す事ができます。  

### クライアントハンドラ

![handler](pictures/handler.png)

1. ポート番号  
   接続する先のポートを指定します。（右も同様）
2. ファイル名  
   ./Clients/内にあるプログラムを指定します。（右も同様）
3. IPアドレス  
   接続先のIPアドレスを指定します
4. 反転ボタン  
   ポート番号のみを入れ替えます。
5. 実行ボタン  
   指定されたファイルを実行します。
6. 状態表示  
   idle: 待機中
   running: 実行中

## マップ変換

./util/内にあります。
選択された.mapファイルを.jsonに変換します。 ./map/内に配置されます。
